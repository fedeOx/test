reference_jdk: &reference_jdk
  JDK="adopt@1.8"
reference_build: &reference_build
  os: linux
  env: *reference_jdk

language: minimal

os:
    - osx
    - windows
    - *reference_os
    
env:
  matrix:
    - *reference_jdk
    - JDK="adopt-openj9@1.8"
    - JDK="adopt@1.11"
    - JDK="adopt-openj9@1.11"
    - JDK="adopt@"
    - JDK="adopt-openj9"
    
stages:
  - base
  - test

before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
  
 jobs:
    exclude:
        - <<: *reference_build
          stage: test
    include:
        - <<: *reference_build
          stage: base
          script:
            - travis_retry ./gradlew clean check
            

script:
  - travis_retry ./gradlew clean check
  
notifications:
  email:
    on_success: never